{% extends 'base.html' %}

{% block title %}{{ subject.name }} - Quiz Journey{% endblock %}

{% block content %}
<div class="quiz-journey-wrapper">
    <div class="journey-breadcrumb">
        <a href="{{ url_for('quiz_journey') }}"><i class="fas fa-arrow-left"></i> Back to Journey</a>
    </div>

    <div class="subject-banner">
        <div class="subject-icon-large">
            <i class="fas fa-book-open"></i>
        </div>
        <h1>{{ subject.name }}</h1>
        <span class="section-badge-large">{{ subject.section }}</span>
    </div>

    <div class="levels-path">
        {% for session in sessions %}
        <div class="level-card {% if session.quiz_count > 0 %}has-quiz{% endif %} {% if session.completed_quizzes > 0 %}completed{% endif %}">
            <div class="level-connector"></div>
            <div class="level-badge">
                <span class="level-num">{{ session.session_number }}</span>
                {% if session.completed_quizzes > 0 and session.quiz_count > 0 %}
                <i class="fas fa-check-circle completed-icon"></i>
                {% endif %}
            </div>
            <div class="level-content">
                <h3>{{ session.title }}</h3>
                {% if session.quiz_count > 0 %}
                <div class="quiz-list">
                    {% set quizzes = [] %}
                    <!-- We need to fetch quizzes here, let's do it via AJAX or include them -->
                </div>
                <a href="{{ url_for('quiz_journey_session', session_id=session.id) }}" class="btn-start-level">
                    <i class="fas fa-play"></i> Start Quiz
                </a>
                {% else %}
                <p class="no-quiz">No quiz available for this session</p>
                {% endif %}
            </div>
            <div class="level-status">
                {% if session.completed_quizzes > 0 %}
                <span class="status-completed"><i class="fas fa-trophy"></i> Completed</span>
                {% elif session.quiz_count > 0 %}
                <span class="status-pending"><i class="fas fa-hourglass-half"></i> Pending</span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
.quiz-journey-wrapper {
    padding: 2rem;
    background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
    min-height: calc(100vh - 70px);
}

.journey-breadcrumb a {
    color: #a5b4fc;
    text-decoration: none;
    font-size: 0.9rem;
}

.journey-breadcrumb a:hover {
    color: white;
}

.subject-banner {
    text-align: center;
    padding: 2rem;
    margin-bottom: 2rem;
}

.subject-icon-large {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    border-radius: 20px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    margin-bottom: 1rem;
}

.subject-banner h1 {
    color: white;
    margin: 0 0 10px 0;
}

.section-badge-large {
    background: rgba(139, 92, 246, 0.5);
    color: white;
    padding: 5px 15px;
    border-radius: 15px;
    font-size: 0.9rem;
}

.levels-path {
    max-width: 800px;
    margin: 0 auto;
}

.level-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    border: 2px solid rgba(255, 255, 255, 0.1);
    position: relative;
    transition: all 0.3s ease;
}

.level-card.has-quiz:hover {
    border-color: #8b5cf6;
    transform: translateX(5px);
}

.level-card.completed {
    border-color: #10b981;
}

.level-connector {
    position: absolute;
    left: 45px;
    bottom: -20px;
    width: 3px;
    height: 20px;
    background: rgba(255, 255, 255, 0.2);
}

.level-card:last-child .level-connector {
    display: none;
}

.level-badge {
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    flex-shrink: 0;
}

.level-card.completed .level-badge {
    background: linear-gradient(135deg, #10b981, #059669);
}

.level-num {
    font-size: 1.5rem;
    font-weight: bold;
    color: white;
}

.completed-icon {
    position: absolute;
    bottom: -5px;
    right: -5px;
    color: #fbbf24;
    font-size: 1.2rem;
    background: #1e1b4b;
    border-radius: 50%;
    padding: 2px;
}

.level-content {
    flex: 1;
}

.level-content h3 {
    color: white;
    margin: 0 0 10px 0;
    font-size: 1.1rem;
}

.no-quiz {
    color: #6b7280;
    font-size: 0.85rem;
    margin: 0;
}

.btn-start-level {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 20px;
    background: linear-gradient(135deg, #8b5cf6, #6d28d9);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn-start-level:hover {
    background: linear-gradient(135deg, #7c3aed, #5b21b6);
    transform: translateY(-2px);
}

.level-status {
    flex-shrink: 0;
}

.status-completed {
    color: #10b981;
    font-weight: 600;
    font-size: 0.85rem;
}

.status-pending {
    color: #fbbf24;
    font-weight: 600;
    font-size: 0.85rem;
}
</style>
{% endblock %}
